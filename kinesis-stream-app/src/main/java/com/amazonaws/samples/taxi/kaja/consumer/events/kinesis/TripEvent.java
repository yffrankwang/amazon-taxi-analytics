/*
 * Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"). You may
 * not use this file except in compliance with the License. A copy of the
 * License is located at
 *
 *    http://aws.amazon.com/apache2.0/
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */

package com.amazonaws.samples.taxi.kaja.consumer.events.kinesis;

import java.util.Date;

public class TripEvent extends Event {
	private static final double[][] LocationId2GeoPoints = new double[][] {
		{ 40.68965340678024, -74.17443021575268	  },
		{ 40.61118429515941, -73.8723711891749	  },
		{ 40.8636110235924, -73.84345403582267	  },
		{ 40.725181016931124, -73.98018480473499	},
		{ 40.5544670567401, -74.18039833011603	  },
		{ 40.60244431568243, -74.06066936722179	  },
		{ 40.76595315733612, -73.92055809224176	  },
		{ 40.7763317270473, -73.92467654387269	  },
		{ 40.76132109836452, -73.78703699797155	  },
		{ 40.67410525195813, -73.78614912207887	  },
		{ 40.607123412900464, -74.00692773425786	},
		{ 40.71259710815176, -74.01630356091695	  },
		{ 40.70781510850139, -74.01677562966934	  },
		{ 40.62642697954617, -74.03061343342029	  },
		{ 40.79092455795137, -73.78190930225584	  },
		{ 40.766143510161456, -73.77007182752908	},
		{ 40.68874691797082, -73.9437158560811	  },
		{ 40.868984780501, -73.89801387129732	  },
		{ 40.736992414637356, -73.71867441728266	},
		{ 40.85487738690425, -73.88947398756106	  },
		{ 40.615506574590675, -73.9973376959558	  },
		{ 40.61368224724973, -74.00909649942433	  },
		{ 40.6078100552906, -74.09613987289161	  },
		{ 40.80046434908484, -73.97056112432745	  },
		{ 40.68640877971375, -73.98690643485598	  },
		{ 40.63323305685661, -73.99151358679934	  },
		{ 40.564456233961536, -73.89624355332475	},
		{ 40.71271242961902, -73.81332985722847	  },
		{ 40.57955027063721, -73.96209604992602	  },
		{ 40.62280549713582, -73.82471742413512	  },
		{ 40.861625961110384, -73.87066300410085	},
		{ 40.85065496750717, -73.86708203358603	  },
		{ 40.69707321448021, -73.99512362113803	  },
		{ 40.70040152838488, -73.97346752207638	  },
		{ 40.66506711009981, -73.91107034470248	  },
		{ 40.697767575835314, -73.91635772531261	},
		{ 40.683059370602884, -73.90828964118091	},
		{ 40.693032991155384, -73.73578970012592	},
		{ 40.63610235138162, -73.89875485610835	  },
		{ 40.680513034976975, -73.99747851377683	},
		{ 40.80998971718115, -73.94892823309699	  },
		{ 40.81797711574018, -73.94626749000908	  },
		{ 40.79875985844699, -73.95651753124176	  },
		{ 40.583621004386174, -74.15231381756925	},
		{ 40.71574007479592, -73.99731006212394	  },
		{ 40.84730809046833, -73.78750611881168	  },
		{ 40.84142947826154, -73.90023240410147	  },
		{ 40.85505051690046, -73.93106761290323	  },
		{ 40.68868003557115, -73.96602182513722	  },
		{ 40.76095441135171, -73.99762837625553	  },
		{ 40.87460192491358, -73.83613922735704	  },
		{ 40.687176961681104, -73.99684937377415	},
		{ 40.78536547513243, -73.8435937513412	  },
		{ 40.68566373263071, -74.00389841831598	  },
		{ 40.57741575363798, -73.9706230255336	  },
		{ 40.740057822113855, -73.86096066490009	},
		{ 40.740057822113855, -73.86096066490009	},
		{ 40.838971012080826, -73.83053690012012	},
		{ 40.837280346089756, -73.89335093415748	},
		{ 40.83979361285953, -73.8896197708561	  },
		{ 40.67653081937512, -73.94687994585654	  },
		{ 40.665463902037914, -73.94499167084699	},
		{ 40.683131950078966, -73.88624512991044	},
		{ 40.76442405421945, -73.74365515407229	  },
		{ 40.693350855745415, -73.98570631759965	},
		{ 40.70462138617144, -73.98284143976295	  },
		{ 40.618951504573495, -74.01705130360604	},
		{ 40.74898613287013, -74.00128844273372	  },
		{ 40.82752438573633, -73.92171775915095	  },
		{ 40.76738884850778, -73.87823841498083	  },
		{ 40.76771387429387, -73.89634868893603	  },
		{ 40.77174406196813, -73.86167309330617	  },
		{ 40.754299868062155, -73.8100910921466	  },
		{ 40.81264796676113, -73.93709889444662	  },
		{ 40.785813639930616, -73.9459394547186	  },
		{ 40.67464581702011, -73.89279849933092	  },
		{ 40.65231416694686, -73.88988025613436	  },
		{ 40.84777954578919, -73.89671998986455	  },
		{ 40.727526266665464, -73.98803298593916	},
		{ 40.71331036518671, -73.95729150828369	  },
		{ 40.88573726371553, -73.83378130123128	  },
		{ 40.73924506600878, -73.88044793135383	  },
		{ 40.73582659946883, -73.89093600929296	  },
		{ 40.52654705028086, -74.19953230929933	  },
		{ 40.64978735984484, -73.95298109061247	  },
		{ 40.601407505765025, -73.75373389449264	},
		{ 40.714670092427966, -74.00840625296493	},
		{ 40.70347937253878, -74.01252612571304	  },
		{ 40.642666124132546, -73.96098457202991	},
		{ 40.74177415830781, -73.98917555445058	  },
		{ 40.62606593387312, -73.93270979902559	  },
		{ 40.7683187451292, -73.82826945248496	  },
		{ 40.75062271991252, -73.84303319499328	  },
		{ 40.856247234527714, -73.90057228586284	},
		{ 40.721021670005214, -73.850140063957	  },
		{ 40.71808903552121, -73.84885261986899	  },
		{ 40.69062261496689, -73.97478293819728	  },
		{ 40.73722206748205, -73.78361831831369	  },
		{ 40.57597869036168, -74.17826069824869	  },
		{ 40.75378332459709, -73.99065755103796	  },
		{ 40.745698281498754, -73.71249951828992	},
		{ 40.69844736628812, -73.88447610491609	  },
		{ 40.68864558187174, -74.02003957451247	  },
		{ 40.698439745333324, -74.04081059961749	},
		{ 40.70156316242109, -74.01441766482495	  },
		{ 40.67387551603, -73.9906669757086	      },
		{ 40.73572374879389, -73.98462780388586	  },
		{ 40.59448294245907, -73.9788939061679	  },
		{ 40.55901329896317, -74.15431612794008	  },
		{ 40.54753558083248, -74.12805193917093	  },
		{ 40.658156737613865, -73.99403121575361	},
		{ 40.731255694512775, -73.94804768194226	},
		{ 40.73849343796373, -74.00443581887978	  },
		{ 40.72919298693202, -74.00113133761306	  },
		{ 40.62237419966723, -74.07671133253554	  },
		{ 40.82993524580986, -73.94695932960103	  },
		{ 40.590802602008885, -73.8102681791939	  },
		{ 40.58847451984606, -74.1586879399563	  },
		{ 40.838552078769496, -73.92734879949842	},
		{ 40.85005302465918, -73.93099355558894	  },
		{ 40.72195756840659, -73.80360867627174	  },
		{ 40.71108931883867, -73.75991940409476	  },
		{ 40.60089073064888, -73.95651676835234	  },
		{ 40.65538430230669, -73.84397359273626	  },
		{ 40.72719792194247, -74.00768492718113	  },
		{ 40.810285077644686, -73.8874114978132	  },
		{ 40.86700376120491, -73.91926350572369	  },
		{ 40.87236136139706, -73.92487256177124	  },
		{ 40.759354333850716, -73.88571986500453	},
		{ 40.70016149416656, -73.79432067534329	  },
		{ 40.71442934445778, -73.78725123820347	  },
		{ 40.646899985956324, -73.77815743224355	},
		{ 40.637807754192664, -73.97487092515907	},
		{ 40.707367221356485, -73.827668225129	  },
		{ 40.725819204272796, -73.8209546411772	  },
		{ 40.871728514890755, -73.89790591825273	},
		{ 40.74040219846961, -73.97985479167279	  },
		{ 40.77707332003254, -73.87392298691512	  },
		{ 40.67490904769128, -73.745527462647	  },
		{ 40.76798397903674, -73.9549563597241	  },
		{ 40.765351235158455, -73.96903259161346	},
		{ 40.77495717418554, -73.97992587903842	  },
		{ 40.773364706248884, -73.9906117989788	  },
		{ 40.721975571369995, -73.9964017876186	  },
		{ 40.747927050569984, -73.94657656031771	},
		{ 40.75050504496991, -73.94103794956189	  },
		{ 40.82536250817268, -73.89171628018589	  },
		{ 40.71697596902556, -73.98689378592437	  },
		{ 40.60900022267695, -73.94965180926562	  },
		{ 40.57872636274727, -73.94423247972648	  },
		{ 40.796831176164304, -73.96729234725383	},
		{ 40.81775537281745, -73.95278634494599	  },
		{ 40.875932161585716, -73.9122637229059	  },
		{ 40.59084628800226, -73.89081295013159	  },
		{ 40.589525077790285, -73.91027519087767	},
		{ 40.63631328589008, -74.1626171149449	  },
		{ 40.72685100119566, -73.91685687533308	  },
		{ 40.740229752676406, -74.00667427354036	},
		{ 40.82470649078968, -73.91234552451331	  },
		{ 40.72267118353565, -73.87972503100045	  },
		{ 40.758220927627036, -73.97628657011218	},
		{ 40.758996116176185, -73.97067657965016	},
		{ 40.76387195173391, -73.97273651602421	  },
		{ 40.74898327930948, -73.96968952680426	  },
		{ 40.61935334995511, -73.96386852290519	  },
		{ 40.80747177019806, -73.96430953360361	  },
		{ 40.82392709562115, -73.90929853529336	  },
		{ 40.80375941181719, -73.92363863931693	  },
		{ 40.84936137941775, -73.90783522319134	  },
		{ 40.74793943402486, -73.97614010899179	  },
		{ 40.76512567521547, -73.80890955919786	  },
		{ 40.575258392495485, -74.11092832898879	},
		{ 40.754927327787684, -73.86818985807176	},
		{ 40.87753442135502, -73.87977518244362	  },
		{ 40.743258660016636, -73.75569051659542	},
		{ 40.565395036473156, -74.11756330189642	},
		{ 40.678713496262596, -73.91074252796824	},
		{ 40.613057158614616, -73.9683754734254	  },
		{ 40.766083170650056, -73.92373382748508	},
		{ 40.67646615203684, -73.85176938594087	  },
		{ 40.66940341553354, -73.9817943583344	  },
		{ 40.83864061644841, -73.8566890138069	  },
		{ 40.850782000750556, -73.8388694131567	  },
		{ 40.85766613614874, -73.82317487564792	  },
		{ 40.85300708535098, -73.8661592061537	  },
		{ 40.74947971910525, -73.99224853115545	  },
		{ 40.634961079658616, -74.12551450471177	},
		{ 40.659145500290684, -73.95541001951788	},
		{ 40.67901128125026, -73.97081844252756	  },
		{ 40.66826277149098, -73.97119784196349	  },
		{ 40.720113040457754, -73.74579304237038	},
		{ 40.74354112503912, -73.82768322453926	  },
		{ 40.755607043151215, -73.9456976440209	  },
		{ 40.79329418167082, -73.92154473756909	  },
		{ 40.6752816159133, -74.01023640606729	  },
		{ 40.728238816364794, -73.86323204120721	},
		{ 40.6967779396981, -73.83602083764826	  },
		{ 40.705108089513566, -73.90631283819171	},
		{ 40.79354731801798, -73.88594752226592	  },
		{ 40.898809725705455, -73.90494886587595	},
		{ 40.580001326766904, -73.8373166413883	  },
		{ 40.76130166766022, -73.95116342226007	  },
		{ 40.660787445110785, -73.73834624190424	},
		{ 40.54233918243044, -74.20347181575667	  },
		{ 40.69309030998591, -73.76485399011217	  },
		{ 40.642063365585706, -74.09165986610853	},
		{ 40.76483047297733, -73.89847201575074	  },
		{ 40.82319259226389, -73.81089932711355	  },
		{ 40.70729819730005, -74.00274894458755	  },
		{ 40.59739895879313, -73.950257508478	  },
		{ 40.72338452407265, -74.00235300701574	  },
		{ 40.82497578229731, -73.87114654643143	  },
		{ 40.817432002144415, -73.8492099296238	  },
		{ 40.59483184042541, -74.08879911270267	  },
		{ 40.6805441629057, -73.78903511490698	  },
		{ 40.67573088240609, -73.81732418220624	  },
		{ 40.70509391560854, -73.95674639501222	  },
		{ 40.671993434716796, -73.78101554906794	},
		{ 40.66774561958554, -73.78637996670871	  },
		{ 40.876739010463545, -73.90486263824684	},
		{ 40.625580010449674, -74.08270544450082	},
		{ 40.649068717318684, -73.88291730470725	},
		{ 40.7725300393005, -73.90752428420333	  },
		{ 40.73215103684695, -73.9802773717907	  },
		{ 40.68178441868997, -73.93759597292666	  },
		{ 40.742233296896856, -73.92423315365383	},
		{ 40.65999306025641, -73.99085256396475	  },
		{ 40.642866865039224, -74.0230390698093	  },
		{ 40.758179710007674, -73.9603288459996	  },
		{ 40.75944206687301, -73.98448653228515	  },
		{ 40.716208567297635, -74.00309708456307	},
		{ 40.715443524638964, -73.98828566711613	},
		{ 40.7572082201891, -73.97552601319741	  },
		{ 40.73636504172372, -73.99055531546875	  },
		{ 40.854865411104306, -73.90990282730841	},
		{ 40.8292948483315, -73.94596144712551	  },
		{ 40.764578358486695, -73.95694777445378	},
		{ 40.80457315552834, -73.97042808082436	  },
		{ 40.77143073103562, -73.98742255591027	  },
		{ 40.89736114513054, -73.88607753108832	  },
		{ 40.88377078108512, -73.89586955615042	  },
		{ 40.8833489860458, -73.8952472837041	  },
		{ 40.85801164788935, -73.93711130008224	  },
		{ 40.83405309598136, -73.9439777546624	  },
		{ 40.63355554101276, -74.11709348257071	  },
		{ 40.754490442380174, -74.00234878876267	},
		{ 40.828595993601795, -73.92592346258131	},
		{ 40.842650355112156, -73.88177652745136	},
		{ 40.73535977455741, -74.00463160636505	  },
		{ 40.847223819471424, -73.84711595488992	},
		{ 40.61772603158653, -74.14233769563502	  },
		{ 40.78863976734675, -73.81644946271403	  },
		{ 40.76104057927883, -73.842029493084	  },
		{ 40.87143830274111, -73.86830298875957	  },
		{ 40.71773781544251, -73.95547584432614	  },
		{ 40.70889632948086, -73.9571563149148	  },
		{ 40.65329381374429, -73.97809807343668	  },
		{ 40.68996635257279, -73.86097424901483	  },
		{ 40.89922122922471, -73.86692329889911	  },
		{ 40.749164351578884, -73.90568106843297	},
		{ 40.712687115361774, -74.0132403167511	  },
		{ 40.77690597252906, -73.94409710517758	  },
		{ 40.77433858069619, -73.95559841659937	  },
	};
	
	public long tripId;
	private long timestamp;

	public double pickupLatitude;
	public double pickupLongitude;
	public int pickupLocationId;
	public double dropoffLatitude;
	public double dropoffLongitude;
	public int dropoffLocationId;
	public long tripDistance;
	public Date pickupDatetime;
	public Date dropoffDatetime;

	public TripEvent() {
	}

	public void normalize() {
		if (dropoffDatetime != null) {
			timestamp = dropoffDatetime.getTime();
		}
		
		if (pickupLocationId > 0 && pickupLocationId <= LocationId2GeoPoints.length) {
			double[] geo = LocationId2GeoPoints[pickupLocationId-1];
			pickupLatitude = geo[0];
			pickupLongitude = geo[1];
		}
		
		if (dropoffLocationId > 0 && dropoffLocationId <= LocationId2GeoPoints.length) {
			double[] geo = LocationId2GeoPoints[dropoffLocationId-1];
			dropoffLatitude = geo[0];
			dropoffLongitude = geo[1];
		}
	}

	@Override
	public long getTimestamp() {
		return timestamp;
	}

	@Override
	public String toString() {
		return "TripEvent{" +
				"tripId=" + tripId +
				", pickupDatetime=" + pickupDatetime +
				", pickupLatitude=" + pickupLatitude +
				", pickupLongitude=" + pickupLongitude +
				", pickupLocationId=" + pickupLocationId +
				", dropoffDatetime=" + dropoffDatetime +
				", dropoffLatitude=" + dropoffLatitude +
				", dropoffLongitude=" + dropoffLongitude +
				", dropoffLocationId=" + dropoffLocationId +
				", tripDistance=" + tripDistance +
				'}';
	}
}
